# REST

REST (Representational State Transfer) — это архитектурный стиль, который используется для создания веб-сервисов и API. Он был предложен Роем Филдингом в его диссертации в 2000 году и стал основой для большинства современных веб-API. REST основывается на нескольких ключевых принципах и ограничениях, которые помогают создавать масштабируемые, надежные и легко расширяемые системы.  

## Основные принципы REST

* ### Клиент-серверная архитектура

Клиент и сервер разделены, что позволяет их независимое развитие. Клиент отвечает за интерфейс пользователя, а сервер — за управление данными и бизнес-логику.  

* ### Stateless (Без сохранения состояния)

Каждый запрос от клиента к серверу должен содержать всю информацию, необходимую для его обработки. Сервер не должен сохранять состояние между запросами. Это упрощает масштабирование, уменьшает время обработки запроса, обеспечивает простоту поддержки, предоставляет возможность использовать кэширование.  

* ### Кэширование (Caching)

Ответы сервера могут быть помечены как кэшируемые или некэшируемые. Если ответ кэшируемый, клиент может повторно использовать его без повторного обращения к серверу, что снижает нагрузку и ускоряет работу системы.  
  
* ### Единообразие интерфейса (Uniform Interface)

Единообразие интерфейса (Uniform Interface) — один из ключевых принципов архитектуры REST, который делает взаимодействие между клиентом и сервером простым и предсказуемым. Этот принцип означает, что API должно иметь стандартные правила для работы с ресурсами, что упрощает понимание и использование API, данный принцип характеризуется следующими аспектами:  

* Идентификация ресурсов

Каждый ресурс (например, пользователь, статья, заказ) должен быть однозначно идентифицирован через URI (Uniform Resource Identifier). URI — это адрес, который указывает на конкретный ресурс.

Пример:

/users/123 — ресурс, представляющий пользователя с идентификатором 123.  
/articles/456 — ресурс, представляющий статью с идентификатором 456.  

* Манипуляция ресурсами через представления

Клиенты работают с представлениями ресурсов, которые передаются в виде данных (например, JSON, XML). Они могут получать, изменять или удалять ресурсы, используя стандартные методы HTTP (GET, POST, PUT, DELETE).  

Пример:

GET-запрос к /users/123 возвращает представление пользователя с идентификатором 123 в виде JSON.  
PUT-запрос к /users/123 обновляет информацию о пользователе.  

* Самоописываемые сообщения

Каждое сообщение (запрос или ответ) содержит всю необходимую информацию для его обработки. Это означает, что клиент и сервер могут понимать, что они обмениваются данными, без необходимости дополнительного контекста.  

Пример:

В HTTP-запросе заголовок Content-Type: application/json указывает, что тело запроса содержит данные в формате JSON.  
Заголовок ответа Content-Type: application/json информирует клиента о том, что тело ответа тоже в формате JSON.  

* Гипермедиа как движок состояния приложения (HATEOAS)  

Этот компонент предполагает, что клиент может навигировать по API с помощью гиперссылок, предоставленных в ответе сервера. Это позволяет клиенту легко находить и использовать другие связанные ресурсы.  
  
Пример:

Ответ на запрос пользователя может включать ссылки на его друзей или сообщения, что позволяет клиенту переходить к этим связанным ресурсам.  

```python
{
  "id": 123,
  "name": "John Doe",
  "_links": {
    "self": { "href": "/users/123" },
    "friends": { "href": "/users/123/friends" }
  }
}
```

Клиент видит ссылку на список друзей и может сделать новый запрос по адресу /users/123/friends

* ### Слои (Layered System)

Архитектура может быть многослойной, где каждый слой выполняет определенные задачи. Это позволяет масштабировать систему, добавляя промежуточные слои, такие как прокси, балансировщики нагрузки и кэш-сервера.  
  
* ### Код по требованию (Code on Demand)

Сервер может передавать исполняемый код клиенту (например, JavaScript), чтобы расширить функциональность клиента. Однако этот принцип используется редко и не является обязательным.  

## Основные элементы REST

* ### Ресурсы

Любой объект, который может быть идентифицирован URL. Например, пользователь, статья, заказ.  

* ### Методы HTTP

Основные методы для работы с ресурсами:  

* GET: Получение ресурса.
* POST: Создание нового ресурса.
* PUT: Полное обновление ресурса.
* PATCH: Частичное обновление ресурса.
* DELETE: Удаление ресурса.

* ### URL (Uniform Resource Locator)

Адрес ресурса.  

* ### Заголовки (Headers)

Метаданные, передаваемые с запросами и ответами (например, Content-Type, Authorization).  

* ### Тело запроса и ответа (Body)

Данные, передаваемые в запросах и ответах (например, JSON, XML).  

## Пример REST API

Рассмотрим простое RESTful API для управления пользователями.  

### 1. Получение списка пользователей (GET)  

Запрос:

```python
GET /users HTTP/1.1
Host: api.example.com
```

Ответ:

```python
HTTP/1.1 200 OK
Content-Type: application/json

[
  {
    "id": 1,
    "name": "John Doe",
    "email": "john.doe@example.com"
  },
  {
    "id": 2,
    "name": "Jane Smith",
    "email": "jane.smith@example.com"
  }
]
```

### 2. Получение конкретного пользователя (GET)

Запрос:

```python
GET /users/1 HTTP/1.1
Host: api.example.com
```

Ответ:

```python
HTTP/1.1 200 OK
Content-Type: application/json

{
  "id": 1,
  "name": "John Doe",
  "email": "john.doe@example.com"
}
```

### 3. Создание нового пользователя (POST)

Запрос:

```python
POST /users HTTP/1.1
Host: api.example.com
Content-Type: application/json

{
  "name": "Alice Johnson",
  "email": "alice.johnson@example.com"
}
```

Ответ:

```python
HTTP/1.1 201 Created
Content-Type: application/json

{
  "id": 3,
  "name": "Alice Johnson",
  "email": "alice.johnson@example.com"
}
```

### 4. Обновление пользователя (PUT)

Запрос:

```python
PUT /users/1 HTTP/1.1
Host: api.example.com
Content-Type: application/json

{
  "name": "John Doe",
  "email": "john.doe@newdomain.com"
}
```

Ответ:

```python
HTTP/1.1 200 OK
Content-Type: application/json

{
  "id": 1,
  "name": "John Doe",
  "email": "john.doe@newdomain.com"
}
```

### 5. Частичное обновление пользователя (PATCH)

Запрос:

```python
PATCH /users/1 HTTP/1.1
Host: api.example.com
Content-Type: application/json

{
  "email": "john.doe@updateddomain.com"
}
```

Ответ:

```python
HTTP/1.1 200 OK
Content-Type: application/json

{
  "id": 1,
  "name": "John Doe",
  "email": "john.doe@updateddomain.com"
}
```

### Удаление пользователя (DELETE)

Запрос:

```python
DELETE /users/1 HTTP/1.1
Host: api.example.com
```

Ответ:

```python
HTTP/1.1 204 No Content
```

## HATEOAS (Hypermedia as the Engine of Application State)

Одним из принципов REST является HATEOAS, который предполагает, что клиент может навигировать по API с помощью гиперссылок, полученных от сервера.  

Пример ответа с HATEOAS:

```python
{
  "id": 1,
  "name": "John Doe",
  "email": "john.doe@example.com",
  "_links": {
    "self": {
      "href": "/users/1"
    },
    "friends": {
      "href": "/users/1/friends"
    },
    "messages": {
      "href": "/users/1/messages"
    }
  }
}
```

Здесь клиент может увидеть ссылки на связанные ресурсы, например, список друзей или сообщения пользователя, и перейти к ним.  

## Заключение

REST — это мощный и гибкий архитектурный стиль, который позволяет создавать масштабируемые и легко поддерживаемые веб-сервисы. Его ключевые принципы, такие как клиент-серверная архитектура, отсутствие сохранения состояния и единообразие интерфейса, обеспечивают основу для построения эффективных API.  
